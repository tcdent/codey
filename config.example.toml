# Codey Configuration Example
# Copy this file to: ~/.config/codey/config.toml

[general]
# Default model to use
model = "claude-sonnet-4-20250514"

# Working directory (default: current directory)
# working_dir = "/path/to/project"

# Maximum tokens for responses
max_tokens = 8192

[auth]
# Authentication method: "oauth" or "api_key"
method = "oauth"

# API key (only if method = "api_key")
# api_key = "sk-ant-..."
#
# Or set the ANTHROPIC_API_KEY environment variable

[ui]
# Syntax highlighting theme
# Available: base16-ocean.dark, base16-ocean.light, InspiredGitHub, Solarized (dark), Solarized (light)
theme = "base16-ocean.dark"

# Enable auto-scroll when new content arrives
auto_scroll = true

# Show token usage in status bar
show_tokens = true

[tools]
# Tools to enable (leave empty for all)
enabled = ["read_file", "write_file", "edit_file", "shell", "fetch_url"]

# Tool parameter filters for auto-approve/auto-deny
# Evaluation order:
#   1. If any deny pattern matches → auto-deny (blocked)
#   2. If any allow pattern matches → auto-approve (no prompt)
#   3. Otherwise → prompt user for approval

# Shell command filters (matches against 'command' parameter)
[tools.shell]
allow = [
    "^ls\\b",           # ls commands
    "^find\\b",         # find commands
    "^cat\\b",          # cat commands
    "^head\\b",         # head commands
    "^tail\\b",         # tail commands
    "^grep\\b",         # grep commands
    "^rg\\b",           # ripgrep commands
    "^wc\\b",           # wc commands
    "^pwd$",            # pwd command
    "^echo\\b",         # echo commands
]
deny = [
    "rm\\s+-rf\\s+/",   # dangerous rm
    "sudo\\s+rm",       # sudo rm
    ":(){ :|:& };:",    # fork bomb
    "\\|\\s*sh\\b",     # piping to shell
    "\\|\\s*bash\\b",   # piping to bash
    "curl.*\\|",        # curl piped to anything
    "wget.*\\|",        # wget piped to anything
]

# Read file filters (matches against 'path' parameter)
[tools.read_file]
allow = [
    "\\.(rs|toml|md|txt|json|yaml|yml|ts|js|py|go|c|h|cpp|hpp)$",  # Common code files
]
deny = [
    "\\.env$",          # Environment files
    "secrets?",         # Secret files
    "\\.pem$",          # Private keys
    "\\.key$",          # Key files
]

# Write file filters (matches against 'path' parameter)
[tools.write_file]
allow = []
deny = [
    "\\.env$",          # Environment files
    "\\.pem$",          # Private keys
    "\\.key$",          # Key files
]

# Edit file filters (matches against 'path' parameter)
[tools.edit_file]
allow = []
deny = [
    "\\.env$",          # Environment files
    "\\.pem$",          # Private keys
]

# URL fetch filters (matches against 'url' parameter)
[tools.fetch_url]
allow = [
    "^https://",        # Only HTTPS
]
deny = [
    "localhost",        # No local requests
    "127\\.0\\.0\\.1",  # No loopback
    "192\\.168\\.",     # No private networks
    "10\\.",            # No private networks
    "172\\.(1[6-9]|2[0-9]|3[01])\\.",  # No private networks
]

# =============================================================================
# Browser Configuration (for fetch_html tool)
# =============================================================================
# Configure Chrome/Chromium settings for the fetch_html tool which uses
# headless browser rendering to fetch web pages.

[browser]
# Path to Chrome/Chromium user data directory.
# This allows sharing cookies and session data with your local browser,
# enabling access to authenticated pages.
#
# How it works:
#   1. Codey copies your Chrome profile to an isolated temp directory
#   2. This avoids Chrome's SingletonLock (which prevents concurrent access)
#   3. Cookies are decrypted using macOS Keychain (or equivalent on other OS)
#
# Common paths:
#   Linux: ~/.config/google-chrome (Chrome) or ~/.config/chromium (Chromium)
#   macOS: ~/Library/Application Support/Google/Chrome
#   Windows: %LOCALAPPDATA%\Google\Chrome\User Data
#
# chrome_user_data_dir = "~/Library/Application Support/Google/Chrome"

# Profile directory name within the user data directory.
# Use this to select a specific Chrome profile (e.g., one created just for Codey).
# If not set, Chrome uses the last-used or Default profile.
#
# To find your profile names, look in the user data directory for folders named
# "Default", "Profile 1", "Profile 2", etc. Or check chrome://version in Chrome.
#
# chrome_profile = "Profile 9"

# Run browser in headless mode (default: true)
# Set to false to see what the browser is doing (useful for debugging)
#
# headless = true

# Viewport dimensions in pixels
# Taller viewports help load more content on infinite-scroll pages like Twitter/X
# Default: 800x4000
#
# viewport_width = 800
# viewport_height = 4000

# Time to wait for JavaScript to render in milliseconds (default: 10000)
# SPAs like Twitter need time to load and render content after initial page load.
# Increase this if pages aren't fully loaded, decrease for faster simple pages.
#
# page_load_wait_ms = 10000
# Custom Chrome/Chromium executable path (optional)
# If not set, auto-detects from PATH or standard installation locations.
#
# chrome_executable = "/usr/bin/google-chrome"

# =============================================================================
# Neovim Integration
# =============================================================================
# Codey connects to Neovim via RPC socket for diff previews, buffer management,
# and navigation. Start nvim with: nvim --listen /tmp/nvim-$(tmux display -p '#S').sock

[ide.nvim]
# Enable neovim integration
enabled = true

# Explicit socket path (optional - auto-discovers from tmux or $NVIM_LISTEN_ADDRESS)
# socket = "/tmp/nvim.sock"

# Show diff/file previews in nvim before approving changes
show_diffs = true

# Automatically reload buffers after file modifications
auto_reload = true
